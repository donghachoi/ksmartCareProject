<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  	<mapper namespace="com.cafe24.choiyooq1.mapper.BoardMapper">
  		<resultMap type="com.cafe24.choiyooq1.domain.CenterBoard" id="BoardMap">
  		    <result property="boardNo" column="board_no" />
  			<result property="boardTitle"  column="board_title"/>
  			<result property="boardContent" column="board_content" />
  			<result property="boardUser" column="board_user" />
  			<result property="boardDate" column="board_date" />
  			<result property="boardFile" column="board_file" />
  			<result property="boardUserId" column="board_userId" />
  		</resultMap>
  		
  		<update id="updateBoard" parameterType="CenterBoard">
  			UPDATE centerboard
			SET
				board_title=	#{boardTitle},
				board_content=	#{boardContent},
				board_file=		#{boardFile},
				board_date=		NOW()
			WHERE 
				board_no = #{boardNo};
  		</update>
  		
  		<!-- 게시물 삭제 -->
  		<delete id="deleteBoard" parameterType="int" >
  			DELETE 
			from
				centerboard
			WHERE 
				board_no = #{boardNo};
  		</delete>
  		<!-- 게시물 등록 -->
  		<insert id="insertBoard" parameterType="CenterBoard">
  			<selectKey resultType="int" keyProperty="boardNo" order="BEFORE">
  				SELECT MAX(board_no)+1 AS board_no 
  				from	centerboard
  			</selectKey>
  			INSERT INTO 
				centerboard
				(board_no, board_title, board_content, board_file, board_user, board_userId, center_code, center_name, board_date)
			VALUES 
				(#{boardNo}, #{boardTitle}, #{boardContent}, #{boardFile}, #{boardUser}, #{boardUserId}, #{centerCode}, #{centerName}, NOW())
  		</insert>
  		
  		<!-- 게시판하나의 리스트 -->
  		<select id="getOneBoardList" parameterType="int" resultMap="BoardMap">
  			SELECT 
				board_no, 
				board_title, 
				board_content, 
				board_file, 
				board_user, 
				board_userId, 
				center_code, 
				center_name, 
				board_date
			FROM 
				centerboard
			WHERE 
				board_no = #{boardNo};
  		</select>
  		
  		<!-- 게시판 전체의 갯수 가져오기 -->
  		<select id="getBoardCount" resultType="double">
			SELECT 
				COUNT(board_no)
			from
				centerboard
  		</select>
  		
  		<!-- 전체 게시판 리스트 -->
  		<select id="getBoardList" resultMap="BoardMap" parameterType="int">
  			SELECT 
				board_no, 
				board_title, 
				board_file, 
				board_user, 
				board_userId, 
				center_code, 
				center_name, 
				board_date
			FROM 
				centerboard
			ORDER BY 
				1 DESC,8 DESC	
			LIMIT 
				${startPage},${LIST_ROW}
  		</select>
  	</mapper>