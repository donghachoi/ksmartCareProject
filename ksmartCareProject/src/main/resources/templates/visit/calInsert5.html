<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default}">

<!-- 사용자css -->
<th:block layout:fragment="customCss">
   <link rel="stylesheet" href="/assets/lib/font-awesome/css/font-awesome.css">
   
    <link rel="stylesheet" href="/vendor/css/fullcalendar.min.css" />
    <link rel="stylesheet" href="/vendor/css/bootstrap.min.css">
    <link rel="stylesheet" href="/vendor/css/select2.min.css" />
    <link rel="stylesheet" href="/vendor/css/bootstrap-datetimepicker.min.css" />

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,500,600">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <link rel="stylesheet" href="/vendor/css/main.css">
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.12/css/dataTables.bootstrap.min.css">
</th:block>
<th:block layout:fragment="customScript">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
	$(document).ready(function(){
		//수급자 정보를 가져옴
		$('.eldername').on('click', function(){
			$('tr').remove('#remove2');
			var id = $(this).attr('data-elder-id');
			var cost = $(this).attr('max-cost');
			var cname = $(this).attr('cname');
				$.ajax({
					type : 'POST',
					url : '/employee/velderbenefitcost',
					data: {elder_id : id},
					dataType : 'json',
					success : function(data){
							
					    var jsonStr = JSON.stringify(data);
					    var ali = JSON.parse(jsonStr);
					    $('#maxCost').text(cost);
					    $('#cname').text(cname);
					    for(var i=0; i<Object.keys(ali).length; i++){ 
					    	var str = '<tr id="remove2"><td>'+ ali[i].visit_service_category+'</td>';
					    	str += '<td>'+ ali[i].visit_service_time+'</td>';
					    	str += '<td>'+ ali[i].visit_plan_time+'</td>';
					    	str += '<td></td>';
					    	str += '<td></td>';
					    	str += '<td></td></tr>';
					    	$("#row1").after(str);
					    }
					},
					error : function(error){
						console.log("error", error);
					}
			});
		});
		
		//직원 분류해서 보여줌
		$('.eldername1').on("click", function(){
			
			var empcategory = $(this).attr('empcategory');
			var empservice = $(this).attr('empservice');
			$.ajax({
				url: "/employee/vemployeecategory",
				data : { empcategory : empcategory},
				dateType: "json",
				type: "GET",
				success : function(data){
					$('#empcategory').find('option').remove();
					$('.modal-title').text(empservice);
					for(var i=0; i<data.length; i++){
						$('#empcategory').append("<option value='"+ data[i].employee_id + "\'>"+ data[i].employee_name +"</option>");
					   }
					},
	            error:function(){
	                alert("ajax통신 실패!!!");
	            }
				
			});
		});
		
	})
	</script>
</th:block>
		
<th:block layout:fragment="customContents">
	<div class="outer">
		<div class="inner bg-light lter">
			<!--Begin Datatables-->
			<div class="row">
				<!--수급자 목록-->
				<div class="col-lg-6">
					<div class="box">
						<header>
							<div class="icons">
								<i class="fa fa-table"></i>
							</div>
							<h5>수급자 목록</h5>
						</header>
						<div id="collapse4" class="body">
							<table id="dataTable"
								class="table table-bordered table-condensed table-hover sortableTable">
								<thead>
									<tr>
										<th>상태</th>
										<th>이름</th>
										<th>등급</th>
										<th>질병구분</th>
										<th>수가한도</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="g: ${list}">
										<td th:text="${g.elder_final_service_status}"></td>
										<td><a href="javascript:void(0)" class="eldername" th:data-elder-id="${g.elder_id}" 
										th:max-cost="${g.benefit_max_cost}" th:cname="${g.elder_name}">[[${g.elder_name}]]</a></td>
										<!-- <td id="eldername"><a th:href="@{/elder_benefit_cost(elder_name=${g.elder_name})}">[[${g.elder_name}]]</a></td>-->
										<td th:text="${g.elder_final_service_approval_level}"></td>
										<td th:text="${g.elder_disease}"></td>
										<td th:text="${g.benefit_max_cost}"></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<!--/수급자 목록-->

				<div class="col-lg-6">

					<!--수급자 제공급여 요약-->
					<div class="box">
						<header>
							<div class="icons">
								<i class="fa fa-table"></i>
							</div>
							<h5>수급자 제공급여 요약</h5>
							<div class="toolbar">
								<div class="btn-group">
									<a href="#defaultTable" data-toggle="collapse"
										class="btn btn-sm btn-default minimize-box"> 
										<i class="fa fa-angle-up"></i>
									</a>
								</div>
							</div>
						</header>

						<div id="collapse4" class="body">
								<!-- /.col-lg-6 -->
						  
							<div class="row form-group">
							 <form th:action="post">
								<div class="col-lg-5">
									<select name ="sk" class="autotab input-sm">
										<option value="2020">2020</option>
										<option value="2019">2019</option>
										<option value="2018">2018</option>
									</select>
									<select name ="sv" class="autotab input-sm">
									<th:block th:each="num: ${#numbers.sequence(1,12)}">
										<option value="${num}">[[${num}]]</option>
									</th:block>
									</select>	
															
							    </div>
							   </form>
									<div style="align:right;">
										<span>이름: </span>
										<span id="cname"></span>
									</div>								
								</div>

							<!-- /.row -->
							<!-- /.col-lg-6 -->

								<div id="collapse4" class="body">
									<table
										class="table table-bordered table-condensed table-hover table-striped">
										<thead>
											<tr>
												<th colspan="2">급여한도</th>
												<th id="maxCost"></th>
												<th colspan="2">급여 잔액</th>
												<th id="mixCost"> </th>
											</tr>
										</thead>
										<tbody>
											<tr id="row1">
												<td>구분</td>
												<td>횟수</td>
												<td>급여 계</td>
												<td>본인부담</td>
												<td>비급여+초과</td>
												<td>수당</td>
											</tr>
											<tr>
												<td>계</td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
							<!--/수급자 제공급여 요약-->


					</div>
			</div>
			<!-- /.row -->
			<!--End Datatables-->

			<!--방문등록  -->

	        <!-- 일자 클릭시 메뉴오픈 -->
	        <div id="contextMenu" class="dropdown clearfix">
	            <ul class="dropdown-menu dropNewEvent" role="menu" aria-labelledby="dropdownMenu"
	                style="display:block;position:static;margin-bottom:5px;">
	                <li><a tabindex="-1" href="javascript:void(0)" class="eldername1" th:empcategory="요양보호사" th:empservice="방문요양">방문요양</a></li>
	                <li><a tabindex="-1" href="javascript:void(0)" class="eldername1" th:empcategory="요양보호사" th:empservice="방문목욕">방문목욕</a></li>
	                <li><a tabindex="-1" href="javascript:void(0)" class="eldername1" th:empcategory="간호조무사" th:empservice="방문간호">방문간호</a></li>
	                <li class="divider"></li>
	                <li><a tabindex="-1" href="#" data-role="close">Close</a></li>
	            </ul>
	        </div>
	
	        <div id="wrapper">
	            <div id="loading"></div>
	            <div id="calendar"></div>
	        </div>
	
	
	        <!-- 일정 추가 MODAL -->
	        <div class="modal fade" tabindex="-1" role="dialog" id="eventModal">
	            <div class="modal-dialog" role="document">
	                <div class="modal-content">
	                    <div class="modal-header">
	                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
	                                aria-hidden="true">&times;</span></button>
	                        <h4 class="modal-title"></h4>
	                    </div>
	                    <div class="modal-body">
	
	                        <div class="row">
	                            <div class="col-xs-12">
	                                <label class="col-xs-4" for="edit-allDay">비급여 체크</label>
	                                <input class='allDayNewEvent' id="edit-allDay" type="checkbox">
	                            </div>
	                        </div>
	
	                        <div class="row">
	                            <div class="col-xs-12">
	                                <label class="col-xs-4" for="edit-title">요양사 선택</label>
	                                <select class="inputModal" type="text" name="empcategory" id="empcategory">               
	                                </select>
	                            </div>
	                        </div>
	                        <div class="row">
	                            <div class="col-xs-12">
	                                <label class="col-xs-4" for="edit-start">시작</label>
	                                <input class="inputModal" type="text" name="edit-start" id="edit-start" />
	                            </div>
	                        </div>
	                        <div class="row">
	                            <div class="col-xs-12">
	                                <label class="col-xs-4" for="edit-end">끝</label>
	                                <input class="inputModal" type="text" name="edit-end" id="edit-end" />
	                            </div>
	                        </div>
	                        <div class="row">
	                            <div class="col-xs-12">
	                                <label class="col-xs-4" for="edit-type">구분</label>
	                                <select class="inputModal" type="text" name="edit-type" id="edit-type">               
	                                    <option value="카테고리1">방문요양</option>
	                                    <option value="카테고리2">방문목욕</option>
	                                    <option value="카테고리3">방문간호</option>
	                                </select>
	                            </div>
	                        </div>
	                        <div class="row">
	                            <div class="col-xs-12">
	                                <label class="col-xs-4" for="edit-color">색상</label>
	                                <select class="inputModal" name="color" id="edit-color">
	                                    <option value="#D25565" style="color:#D25565;">빨간색</option>
	                                    <option value="#9775fa" style="color:#9775fa;">보라색</option>
	                                    <option value="#ffa94d" style="color:#ffa94d;">주황색</option>
	                                    <option value="#74c0fc" style="color:#74c0fc;">파란색</option>
	                                    <option value="#f06595" style="color:#f06595;">핑크색</option>
	                                    <option value="#63e6be" style="color:#63e6be;">연두색</option>
	                                    <option value="#a9e34b" style="color:#a9e34b;">초록색</option>
	                                    <option value="#4d638c" style="color:#4d638c;">남색</option>
	                                    <option value="#495057" style="color:#495057;">검정색</option>
	                                </select>
	                            </div>
	                        </div>
	                        <div class="row">
	                            <div class="col-xs-12">
	                                <label class="col-xs-4" for="edit-desc">설명</label>
	                                <textarea rows="4" cols="50" class="inputModal" name="edit-desc"
	                                    id="edit-desc"></textarea>
	                            </div>
	                        </div>
	                    </div>
	                    <div class="modal-footer modalBtnContainer-addEvent">
	                        <button type="button" class="btn btn-default" data-dismiss="modal">취소</button>
	                        <button type="button" class="btn btn-primary" id="save-event">저장</button>
	                    </div>
	                    <div class="modal-footer modalBtnContainer-modifyEvent">
	                        <button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
	                        <button type="button" class="btn btn-danger" id="deleteEvent">삭제</button>
	                        <button type="button" class="btn btn-primary" id="updateEvent">저장</button>
	                    </div>
	                </div><!-- /.modal-content -->
	            </div><!-- /.modal-dialog -->
	        </div><!-- /.modal -->
	
	        <div class="panel panel-default">
	
	            <div class="panel-heading">
	                <h3 class="panel-title">필터</h3>
	            </div>
	
	            <div class="panel-body">
	
	                <div class="col-lg-6">
	                    <label for="calendar_view">구분별</label>
	                    <div class="input-group">
	                        <select class="filter" id="type_filter" multiple="multiple">
	                            <option value="카테고리1">카테고리1</option>
	                            <option value="카테고리2">카테고리2</option>
	                            <option value="카테고리3">카테고리3</option>
	                            <option value="카테고리4">카테고리4</option>
	                        </select>
	                    </div>
	                </div>
	
	                <div class="col-lg-6">
	                    <label for="calendar_view">등록자별</label>
	                    <div class="input-group">
	                        <label class="checkbox-inline"><input class='filter' type="checkbox" value="정연"
	                                checked>정연</label>
	                        <label class="checkbox-inline"><input class='filter' type="checkbox" value="다현"
	                                checked>다현</label>
	                        <label class="checkbox-inline"><input class='filter' type="checkbox" value="사나"
	                                checked>사나</label>
	                        <label class="checkbox-inline"><input class='filter' type="checkbox" value="나연"
	                                checked>나연</label>
	                        <label class="checkbox-inline"><input class='filter' type="checkbox" value="지효"
	                                checked>지효</label>
	                    </div>
	                </div>
	
	            </div>
	        </div>
	        <!-- /.filter panel -->
	    </div>
	    <!-- /.container -->

		<!-- /방문등록  -->
		</div>

	<!-- /.outer -->
</th:block>
<th:block layout:fragment="customPlugin">
	<!--jQuery -->
	<script src="/assets/lib/jquery/jquery.js"></script>
	<!-- Tables -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
	<script src="/assets/js/jquery.dataTables.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.12/js/dataTables.bootstrap.min.js"></script>
	<!-- 움직임 관련  -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.26.6/js/jquery.tablesorter.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>

	<!-- 캘린더 -->
    <!--  <script src="/vendor/js/jquery.min.js"></script>  Search 안나옴-->
    <script src="/vendor/js/bootstrap.min.js"></script>
    <script src="/vendor/js/moment.min.js"></script>
    <script src="/vendor/js/fullcalendar.min.js"></script>
    <script src="/vendor/js/ko.js"></script>
    <script src="/vendor/js/select2.min.js"></script>
    <script src="/vendor/js/bootstrap-datetimepicker.min.js"></script>
    <script src="/vendor/js/main.js"></script>
    <script src="/vendor/js/addEvent.js"></script>
    <script src="/vendor/js/editEvent.js"></script>
    <script src="/vendor/js/etcSetting.js"></script>


	<!-- 셀렉트 박스  -->

	
	<!--Bootstrap -->
	<script src="/assets/lib/bootstrap/js/bootstrap.js"></script>
	<!-- MetisMenu -->
	<script src="/assets/lib/metismenu/metisMenu.js"></script>
	<!-- onoffcanvas -->
	<script src="/assets/lib/onoffcanvas/onoffcanvas.js"></script>
	<!-- Screenfull -->
	<script src="/assets/lib/screenfull/screenfull.js"></script>

	<!-- Metis core scripts -->
	<script src="/assets/js/core.js"></script>
	<!-- Metis demo scripts -->
	<script src="/assets/js/app.js"></script>

	<script>
		$(function() {
			//Metis.MetisCalendar();
			Metis.MetisTable();
			//Metis.metisSortable();
		});
	</script>
	<script src="/assets/js/style-switcher.js"></script>
</th:block>
</html>